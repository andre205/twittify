if (self.CavalryLogger) { CavalryLogger.start_js(["UVlqN"]); }

__d('AsyncUploadBase',['ArbiterMixin','AsyncRequest','AsyncResponse','BrowserSupport','Form','forEachObject','mixin','removeFromArray'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('mixin')(c('ArbiterMixin')));i=h&&h.prototype;j.parseFiles=function(l){'use strict';var m={};c('forEachObject')(l,function(n,o){if(Array.isArray(n)){m[o]=n;}else{m[o]=[];if(n instanceof window.FileList){for(var p=0;p<n.length;p++)m[o].push(n.item(p));}else if(n instanceof window.File||n instanceof window.Blob)m[o].push(n);}});return m;};function j(l){'use strict';i.constructor.call(this);this._customHeader={};this.setURI(l);this.setNetworkErrorRetryLimit(0);}j.prototype.setAllowCrossOrigin=function(l){'use strict';this._allowCrossOrigin=!!l;return this;};j.prototype.setAllowCrossPageTransition=function(l){'use strict';this._allowCrossPageTransition=!!l;return this;};j.prototype.setCustomHttpHeader=function(l,m){'use strict';this._customHeader[l]=m;return this;};j.prototype.setData=function(l){'use strict';this._data=l;return this;};j.prototype.setLimit=function(l){'use strict';this._limit=l;return this;};j.prototype.setNetworkErrorRetryLimit=function(l){'use strict';this._retryLimit=l;return this;};j.prototype.setPreprocessHandler=function(l){'use strict';this._preprocessHandler=l;return this;};j.prototype.setRelativeTo=function(l){'use strict';this._relativeTo=l;return this;};j.prototype.setStatusElement=function(l){'use strict';this._statusElement=l;return this;};j.prototype.setURI=function(l){'use strict';this._uri=l;return this;};j.prototype.suspend=function(){'use strict';this._suspended=true;return this;};j.prototype.resume=function(){'use strict';this._suspended=false;this._processQueue();return this;};j.prototype.isUploading=function(){'use strict';return this._inFlight;};j.prototype._createFileUpload=function(l,m,n){'use strict';return new k(l,m,n);};j.prototype._processQueue=function(){'use strict';if(this._suspended)return;while(this._pending.length<this._limit){if(!this._waiting.length)break;var l=this._waiting.shift();if(this._preprocessHandler){this._preprocessHandler(l,this._processUpload.bind(this));}else this._processUpload(l);this._pending.push(l);}};j.prototype._processUpload=function(l){'use strict';var m=c('Form').createFormData(l.getData()||this._data);if(l.getFile()){m.append(l.getName(),l.getFile());var n=l.getFile().uploadID;if(n)m.append('upload_id',n);}var o=new (c('AsyncRequest'))().setAllowCrossOrigin(this._allowCrossOrigin).setAllowCrossPageTransition(this._allowCrossPageTransition).setURI(this._uri).setRawData(m).setStatusElement(this._statusElement).setHandler(this._success.bind(this,l)).setErrorHandler(this._failure.bind(this,l)).setUploadProgressHandler(this._progress.bind(this,l)).setInitialHandler(this._initial.bind(this,l));for(var p in this._customHeader)o.setRequestHeader(p,this._customHeader[p]);if(this._relativeTo)o.setRelativeTo(this._relativeTo);o.send();l.setAsyncRequest(o);this._inFlight=true;if(!l.getRetryCount())this.inform('start',l);};j.prototype._abort=function(l){'use strict';if(this._pending.indexOf(l)!==-1){c('removeFromArray')(this._pending,l);this._processQueue();}c('removeFromArray')(this._waiting,l);l.abort();};j.prototype._initial=function(l){'use strict';if(l.isAborted())return;this.inform('initial',l);};j.prototype._success=function(l,m){'use strict';if(l.isAborted()){this.inform('success_after_abort',m);return;}this._complete(l);this.inform('success',l.handleSuccess(m));this._processQueue();};j.prototype._retryUpload=function(l){'use strict';l.increaseRetryCount();this._processUpload(l);};j.prototype._failure=function(l,m){'use strict';if(l.isAborted())return;if(m.error===1004&&l.getRetryCount()<this._retryLimit)return this._retryUpload(l);this._complete(l);if(this.inform('failure',l.handleFailure(m))!==false)c('AsyncResponse').defaultErrorHandler(m);this._processQueue();};j.prototype._progress=function(l,event){'use strict';if(l.isAborted())return;this.inform('progress',l.handleProgress(event));};j.prototype._complete=function(l){'use strict';c('removeFromArray')(this._pending,l);if(!this._pending.length)this._inFlight=false;};j.isSupported=function(){'use strict';return c('BrowserSupport').hasFileAPI();};Object.assign(j.prototype,{_limit:10});function k(l,m,n){'use strict';this._name=l;this._file=m;this._data=n;this._success=null;this._response=null;this._progressEvent=null;this._request=null;this._numRetries=0;this._aborted=false;}k.prototype.getName=function(){'use strict';return this._name;};k.prototype.getFile=function(){'use strict';return this._file;};k.prototype.setFile=function(l){'use strict';this._file=l;};k.prototype.getData=function(){'use strict';return this._data;};k.prototype.isComplete=function(){'use strict';return this._success!==null;};k.prototype.isSuccess=function(){'use strict';return this._success===true;};k.prototype.getResponse=function(){'use strict';return this._response;};k.prototype.getProgressEvent=function(){'use strict';return this._progressEvent;};k.prototype.setAsyncRequest=function(l){'use strict';this._request=l;return this;};k.prototype.increaseRetryCount=function(){'use strict';this._numRetries++;return this;};k.prototype.getRetryCount=function(){'use strict';return this._numRetries;};k.prototype.isWaiting=function(){'use strict';return !this._request;};k.prototype.isAborted=function(){'use strict';return this._aborted;};k.prototype.abort=function(){'use strict';this._request=null;this._aborted=true;};k.prototype.handleSuccess=function(l){'use strict';this._success=true;this._response=l;this._progressEvent=null;return this;};k.prototype.handleFailure=function(l){'use strict';this._success=false;this._response=l;this._progressEvent=null;return this;};k.prototype.handleProgress=function(event){'use strict';this._progressEvent=event;return this;};f.exports=j;}),null);
__d('AsyncUploadRequest',['AsyncUploadBase'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('AsyncUploadBase'));i=h&&h.prototype;j.prototype.setFiles=function(k){'use strict';this._files=c('AsyncUploadBase').parseFiles(k);return this;};j.prototype.abort=function(){'use strict';this._uploads.forEach(function(k){return this._abort(k);}.bind(this),this);};j.prototype.send=function(){'use strict';if(this._inFlight)return;this._inFlight=true;this._uploads=[];for(var k in this._files)this._files[k].forEach(function(l){this._uploads.push(this._createFileUpload(k,l));}.bind(this));this._waiting=this._uploads.slice(0);this._pending=[];if(this._uploads.length){this._processQueue();}else this._processUpload(this._createFileUpload(null,null));};j.prototype._processQueue=function(){'use strict';i._processQueue.call(this);if(!this._pending.length&&!this._waiting.length)this.inform('complete',this._uploads);};j.isSupported=function(){'use strict';return c('AsyncUploadBase').isSupported();};function j(){'use strict';h.apply(this,arguments);}f.exports=j;}),null);
__d('DOMClone',[],(function a(b,c,d,e,f,g){var h={shallowClone:function j(k){return i(k,false);},deepClone:function j(k){return i(k,true);}};function i(j,k){var l=j.cloneNode(k);if(typeof l.__FB_TOKEN!=='undefined')delete l.__FB_TOKEN;return l;}f.exports=h;}),null);
__d('FileForm',['ArbiterMixin','AsyncRequest','AsyncResponse','AsyncUploadRequest','BehaviorsMixin','CurrentUser','DataStore','DOMQuery','Event','Form','JSONPTransport','Parent','URI','isElementNode','mixin','shield'],(function a(b,c,d,e,f,g){var h,i;function j(m){var n={},o=c('DOMQuery').scry(m,'input[type="file"]');o.forEach(function(p){n[p.name]=p.files;});return n;}function k(m){var n=c('DOMQuery').scry(m,'input[type="file"]');n.forEach(function(o){o.files=null;});}h=babelHelpers.inherits(l,c('mixin')(c('ArbiterMixin'),c('BehaviorsMixin')));i=h&&h.prototype;function l(m,n,o){'use strict';i.constructor.call(this);this._handleSubmit=function(event){if(event.isDefaultPrevented()||event.getTarget()!==this._form)return;if(this.inform('submit')===false){event.prevent();return;}this.submit(event);}.bind(this);if(m.getAttribute('rel')==='async')throw new Error('FileForm cannot be used with Primer forms.');if(m.getAttribute('method').toUpperCase()!=='POST')throw new Error('FileForm must be used with POST forms.');this._form=m;this._previousEncoding=this._form.enctype;this._form.enctype=this._form.encoding='multipart/form-data';this._files=null;this._customHeader={};n&&this.enableBehaviors(n);this._options=o||{};this.setAllowCrossOrigin(this._options.allowCrossOrigin);this.setAllowCrossPageTransition(this._options.allowCrossPageTransition);this.setUploadInParallel(this._options.uploadInParallel);this.setConcurrentLimit(this._options.concurrentLimit);this.setPreprocessHandler(this._options.preprocessHandler);this.setNetworkErrorRetryLimit(this._options.networkErrorRetryLimit);this._listeners=[c('Event').listen(document.documentElement,'submit',this._handleSubmit),c('Event').listen(this._form,'click',this._click.bind(this))];c('DataStore').set(this._form,'FileForm',this);}l.prototype.getRoot=function(){'use strict';return this._form;};l.prototype.setAllowCrossOrigin=function(m){'use strict';this._allowCrossOrigin=!!m;return this;};l.prototype.setAllowCrossPageTransition=function(m){'use strict';this._allowCrossPageTransition=!!m;return this;};l.prototype.setUploadInParallel=function(m){'use strict';this._uploadInParallel=!!m;return this;};l.prototype.setConcurrentLimit=function(m){'use strict';this._concurrentLimit=m;return this;};l.prototype.setCustomHttpHeader=function(m,n){'use strict';this._customHeader[m]=n;return this;};l.prototype.setPreprocessHandler=function(m){'use strict';this._preprocessHandler=m;return this;};l.prototype.setNetworkErrorRetryLimit=function(m){'use strict';this._retryLimit=m;return this;};l.prototype.setFiles=function(m){'use strict';this._files=m;return this;};l.prototype.canUseXHR=function(){'use strict';var m='FormData' in window;if(m)if(!new (c('URI'))(this._form.action).isSameOrigin()&&!this._allowCrossOrigin)m=false;return m;};l.prototype._click=function(event){'use strict';var m=event.getTarget();while(c('isElementNode')(m)){if(m.type==='submit'){this._clickTarget=m;setTimeout(this._unclick.bind(this),0);break;}m=m.parentNode;}};l.prototype._unclick=function(){'use strict';this._clickTarget=null;};l.prototype._sendViaFrame=function(){'use strict';var m=this._request=new (c('AsyncRequest'))();m.setStatusElement(this._getStatusElement());m.addStatusIndicator();m.setOption('useIframeTransport',true);var n=m.handleResponse.bind(m),o=new (c('JSONPTransport'))('iframe',this._form.action,n),p=o.getTransportFrame(),q=o.getRequestURI().addQueryData({__iframe:true,__user:c('CurrentUser').getID()});this._form.setAttribute('action',q.toString());this._form.setAttribute('target',p.name);m.setJSONPTransport(o);m.setURI(q);m.setHandler(this.success.bind(this,null));m.setErrorHandler(this.failure.bind(this,null));m.setInitialHandler(c('shield')(this.initial,this,null));};l.prototype._sendViaXHR=function(event){'use strict';var m;if(this._uploadInParallel&&c('AsyncUploadRequest').isSupported()){m=new (c('AsyncUploadRequest'))().setPreprocessHandler(this._preprocessHandler).setData(c('Form').serialize(this._form,this._clickTarget)).setNetworkErrorRetryLimit(this._retryLimit);for(var n in this._customHeader)m.setCustomHttpHeader(n,this._customHeader[n]);if(this._concurrentLimit)m.setLimit(this._concurrentLimit);if(this._files){m.setFiles(this._files);}else m.setFiles(j(this._form));var o=[m.subscribe('progress',function(s,t){this.progress(t,t.getProgressEvent());}.bind(this)),m.subscribe('initial',function(s,t){this.initial(t,t.getResponse());}.bind(this)),m.subscribe('success',function(s,t){this.success(t,t.getResponse());}.bind(this)),m.subscribe('start',function(s,t){this.inform('start',{upload:t});}.bind(this)),m.subscribe('failure',function(s,t){this.failure(t,t.getResponse());return false;}.bind(this)),m.subscribe('complete',function(){while(o.length)o.pop().unsubscribe();})];}else{var p;if(this._files){p=c('Form').createFormData(c('Form').serialize(this._form,this._clickTarget));var q=c('AsyncUploadRequest').parseFiles(this._files);for(var n in q){var r=q[n];if(r.length===1){p.append(n,r[0]);}else{n=n+'[]';r.forEach(function(s){p.append(n,s);});}}}else p=c('Form').createFormData(this._form,this._clickTarget);m=new (c('AsyncRequest'))().setRawData(p).setHandler(this.success.bind(this,null)).setErrorHandler(this.failure.bind(this,null)).setUploadProgressHandler(this.progress.bind(this,null)).setInitialHandler(c('shield')(this.initial,this,null));}m.setAllowCrossOrigin(this._allowCrossOrigin).setAllowCrossPageTransition(this._allowCrossPageTransition).setRelativeTo(this._form).setStatusElement(this._getStatusElement()).setURI(this._form.action).send();this._request=m;event&&event.prevent();};l.prototype.forceSendViaXHR=function(){'use strict';return this._sendViaXHR(null);};l.prototype.initial=function(m){'use strict';return this.inform('initial',{upload:m});};l.prototype.success=function(m,n){'use strict';var o={response:n,upload:m};if(this.inform('success',o)!==false)c('Event').fire(this._form,'success',o);this._cleanup();};l.prototype.failure=function(m,n){'use strict';var o={response:n,upload:m};if(this.inform('failure',o)!==false)if(c('Event').fire(this._form,'error',o)!==false)c('AsyncResponse').defaultErrorHandler(n);this._cleanup();};l.prototype.progress=function(m,event){'use strict';this.inform('progress',{event:event,upload:m});};l.prototype.abort=function(){'use strict';if(this._request){this._request.abort();this._cleanup();}};l.prototype.clear=function(){'use strict';k(this._form);};l.prototype.destroy=function(){'use strict';this._cleanup();while(this._listeners&&this._listeners.length)this._listeners.pop().remove();this._listeners=null;this._form.enctype=this._form.encoding=this._previousEncoding;c('DataStore').remove(this._form,'FileForm');};l.prototype.submit=function(event){'use strict';this.canUseXHR()?this._sendViaXHR(event):this._sendViaFrame();};l.prototype._cleanup=function(){'use strict';this._request=null;};l.prototype._getStatusElement=function(){'use strict';return c('Parent').byClass(this._form,'stat_elem')||this._form;};l.getInstance=function(m){'use strict';return c('DataStore').get(m,'FileForm');};Object.assign(l,{EVENTS:['start','submit','initial','progress','success','failure']});f.exports=l;}),null);
__d('FileInput',['cx','ArbiterMixin','DOM','DOMClone','Event','Focus','Keys','UserAgent_DEPRECATED','mixin'],(function a(b,c,d,e,f,g,h){var i,j,k=c('UserAgent_DEPRECATED').ie();i=babelHelpers.inherits(l,c('mixin')(c('ArbiterMixin')));j=i&&i.prototype;function l(m,n,o){'use strict';j.constructor.call(this);this.container=m;this.control=n;var p=c('DOM').scry(this.container,'a')[0];p&&p.removeAttribute('href');var q=c('DOM').create('div',{className:"_3jk"},o);c('DOM').appendContent(this.control,q);this._boundHandleChange=this._handleChange.bind(this);if(k)this._boundHandleIEKeyDown=this._handleIEKeyDown.bind(this);this._setInputElement(o);}l.prototype.getValue=function(){'use strict';return this.input.value;};l.prototype.getInput=function(){'use strict';return this.input;};l.prototype.getContainer=function(){'use strict';return this.container;};l.prototype.getControl=function(){'use strict';return this.control;};l.prototype.clear=function(){'use strict';this.input.value='';if(this.input.value!==''){var m=c('DOMClone').deepClone(this.input);c('DOM').replace(this.input,m);this._setInputElement(m);}};l.prototype.destroy=function(){'use strict';this._focus.remove();this._focus=null;this._listener.remove();this._listener=null;if(k){this._IEKeyDownListener.remove();this._IEKeyDownListener=null;}this.container=null;this.control=null;this.input=null;};l.prototype._setInputElement=function(m){'use strict';this.input=m;this._focus&&this._focus.remove();this._focus=c('Focus').relocate(m,this.control);this._listener&&this._listener.remove();this._listener=c('Event').listen(m,'change',this._boundHandleChange);if(k){this._IEKeyDownListener&&this._IEKeyDownListener.remove();this._IEKeyDownListener=c('Event').listen(m,'keydown',this._boundHandleIEKeyDown);}};l.prototype._handleChange=function(event){'use strict';this.inform('change',event);if(this.input){var m=this.input.form;if(m&&k<9)c('Event').fire(m,'change',event);}};l.prototype._handleIEKeyDown=function(event){'use strict';if(event.keyCode===c('Keys').RETURN){event.preventDefault();var m=document.createEvent('MouseEvents');m.initEvent('click',true,true);this.input.dispatchEvent(m);}};f.exports=l;}),null);
__d("PhotosUploadID",[],(function a(b,c,d,e,f,g){var h=1024,i={getNewID:function j(){return (h++).toString();}};f.exports=i;}),null);
__d('PhotosMimeType',[],(function a(b,c,d,e,f,g){var h={isImage:function j(k){return i(k)[0]==='image';},isJpeg:function j(k){var l=i(k);return h.isImage(k)&&(l[1]==='jpeg'||l[1]==='pjpeg');}};function i(j){return j.split('/');}f.exports=h;}),null);