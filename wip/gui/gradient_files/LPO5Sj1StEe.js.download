if (self.CavalryLogger) { CavalryLogger.start_js(["GXcL4"]); }

__d('createContentStateForTextWithMessengerEmoji',['ContentState','DraftModifier','MessengerSupportedEmojiUtils','insertMessengerEmojiIntoContentState'],(function a(b,c,d,e,f,g){'use strict';function h(i){var j=c('ContentState').createFromText('');while(i){var k=c('MessengerSupportedEmojiUtils').getEmojiMatchObj(i);if(k){var l=k.offset+k.length,m=i.substr(0,k.is_supported?k.offset:l),n=i.substr(l);j=c('DraftModifier').insertText(j,j.getSelectionAfter(),m);if(k.is_supported)j=c('insertMessengerEmojiIntoContentState')(k.emoji_key,j,j.getSelectionAfter(),j.getFirstBlock().getInlineStyleAt(0));i=n;}else break;}if(i)j=c('DraftModifier').insertText(j,j.getSelectionAfter(),i);return j;}f.exports=h;}),null);
__d('getVisibleValueForContentState',['DraftEntity','emptyFunction'],(function a(b,c,d,e,f,g){function h(i){var j=i.getBlockMap().map(function(k){var l=k.getText(),m='';k.findEntityRanges(c('emptyFunction').thatReturnsTrue,function(n,o){var p=k.getEntityAt(n);if(p===null){m+=l.slice(n,o);}else{var q=c('DraftEntity').get(p);if(q.getType()==='EMOTICON'){m+=q.getData().originalEmoticon;}else if(q.getType()==='EMOJI'){m+=q.getData().emoji.join('');}else m+=l.slice(n,o);}});return m;});return j.join('\n');}f.exports=h;}),null);
__d('MessengerTextWithEmojiInput.react',['cx','CompositeDraftDecorator','ContentState','DraftEditor.react','EditorState','FbtResult','MercuryConfig','MessengerEmojiSpan.react','React','XUICloseButton.react','createContentStateForTextWithMessengerEmoji','getEntityMatcher','getVisibleValueForContentState','getVisibleValueForContentStateWithMessengerEmoji','handleBeforeInputForMessengerEmoji','joinClasses'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').PureComponent);j=i&&i.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.$MessengerTextWithEmojiInput5=function(r){if(r!==this.state.editorState){var s=!r.getCurrentContent().hasText();this.setState({editorState:r,isEmpty:s});this.props.onChange&&this.props.onChange(s);}}.bind(this),this.$MessengerTextWithEmojiInput2=function(){return new (c('CompositeDraftDecorator'))([{strategy:c('getEntityMatcher')(function(r){return r.getType()==='EMOJI';}),component:c('MessengerEmojiSpan.react')}]);},this.focusInput=function(){this.refs.input.focus();this.$MessengerTextWithEmojiInput5(c('EditorState').moveFocusToEnd(this.state.editorState));}.bind(this),this.$MessengerTextWithEmojiInput3=function(r,s){if(this.props.maxLength&&this.props.maxLength<=this.getValue().length)return 'handled';var t=c('handleBeforeInputForMessengerEmoji')(s,r);if(t===s)return 'not-handled';this.setState({editorState:t});return 'handled';}.bind(this),this.$MessengerTextWithEmojiInput4=function(r,s){this.props.onReturn&&this.props.onReturn(r,s);return 'handled';}.bind(this),this.$MessengerTextWithEmojiInput6=function(){this.setState({editorState:this.$MessengerTextWithEmojiInput1('')});}.bind(this),this.state={editorState:this.$MessengerTextWithEmojiInput1(this.props.initialValue),isEmpty:!this.props.initialValue||this.props.initialValue.length===0},n;}l.prototype.$MessengerTextWithEmojiInput1=function(m){return c('EditorState').createWithContent(c('createContentStateForTextWithMessengerEmoji')(m||''),this.$MessengerTextWithEmojiInput2());};l.prototype.componentDidMount=function(){this.focusInput();};l.prototype.render=function(){var m=this.props.placeholder&&this.props.placeholder.toString();return c('React').createElement('div',{className:c('joinClasses')(this.props.className,"_30e7")},c('React').createElement('div',{className:"_5j5f _3oh-"},c('React').createElement(c('DraftEditor.react'),{editorState:this.state.editorState,handleBeforeInput:this.$MessengerTextWithEmojiInput3,handleReturn:this.$MessengerTextWithEmojiInput4,onChange:this.$MessengerTextWithEmojiInput5,placeholder:m,ref:'input',spellCheck:false,stripPastedStyles:true,textAlignment:'left'})),c('React').createElement(c('XUICloseButton.react'),{size:'small',onMouseDown:this.$MessengerTextWithEmojiInput6,className:(this.state.isEmpty?"hidden_elem":'')+(' '+"_5j5l")}));};l.prototype.getValue=function(){var m=this.state.editorState.getCurrentContent();return c('getVisibleValueForContentStateWithMessengerEmoji')(m);};l.propTypes={onReturn:k.func,maxLength:k.number,onChange:k.func,placeholder:k.node,initialValue:k.string};f.exports=l;}),null);